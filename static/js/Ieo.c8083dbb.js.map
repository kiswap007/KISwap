{"version":3,"sources":["webpack:///./src/views/ieo/index.vue?d731","webpack:///./src/views/ieo/index.vue","webpack:///./src/views/ieo/index.vue?edcd"],"names":["class","h1","h4","$t","project","symbol","type","amount","placeholder","kisAmount","components","IndexTop","setup","store","route","t","data","themeMode","state","rate","web3","provider","address","accounts","ieoContract","tokenContract","kis","config","kisAddress","tokenAllowance","haveAmount","Number","toFixed","id","params","initContract","eth","Contract","ikoAbi","iko","usdtAddress","getTokenAllowance","getInfo","initWallet","initWeb3","methods","allowance","call","then","approveToken","approve","send","from","result","haveBuyAmount","dividedBy","Math","pow","swap","error","decimals","multipliedBy","invest","val","refData","render","__scopeId"],"mappings":"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","file":"static/js/Ieo.c8083dbb.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=ae79fb3e&lang=scss&scoped=true\"","<template>\r\n  <div class=\"page\">\r\n    <index-top \r\n      :h1=\"'KISwap'\"\r\n      :h4=\"$t('index.集DEX、IKO、DAO、聚合交易为一体的DEFI生态平台')\"></index-top>\r\n    <!-- <div class=\"top-text\">\r\n      {{$t('ieo.注意：我们只支持okexchainkis，不要转移etherummainnet令牌')}}\r\n    </div> -->\r\n    <div class=\"form-block\">\r\n      <div class=\"cell-row flex-middle\">\r\n        <div class=\"label\">{{project ? project.symbol : ''}}{{$t('index.数量')}}</div>\r\n        <div class=\"flex-item cont\">\r\n          <input type=\"number\" v-model=\"amount\" :placeholder=\"$t('ieo.请输入')\" class=\"input-style\">\r\n        </div>\r\n      </div>\r\n      <div class=\"cell-msg\">{{$t('ieo.USDT数量', {num: kisAmount})}}</div>\r\n      <!-- <div class=\"form-btn\" v-if=\"!address\" @click=\"initWallet\">{{$t('ieo.连接钱包')}}</div>\r\n      <div class=\"form-btn\" v-else-if=\"!Number(tokenAllowance)\" @click=\"approveToken\">{{$t('ieo.授权USDT代币')}}</div>\r\n      <div class=\"form-btn\" v-else @click=\"swap\">{{$t('index.兑换')}}</div> -->\r\n       <div class=\"form-btn\">{{$t('ieo.已结束')}}</div>\r\n      <div class=\"info-box flex-between\">\r\n        <div class=\"num\">已抢60000.00KIS</div>\r\n        <div class=\"num\">还剩0.00</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport IndexTop from \"@/views/index/IndexTop\";\r\nimport { reactive, toRefs, computed, watch} from \"vue\";\r\nimport ikoAbi from \"@/utils/ikoAbi\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport {useStore} from \"vuex\";\r\nimport { MaxUint256 } from \"@ethersproject/constants\";\r\nimport { useRoute } from \"vue-router\";\r\nimport web3Data from \"@/utils/initWeb3\";\r\nimport { ElMessage } from 'element-plus';\r\nimport config from \"@/utils/config\";\r\nimport { useI18n } from \"vue-i18n\";\r\nexport default {\r\n  components: {\r\n    IndexTop\r\n  },\r\n  setup () {\r\n     const store = useStore();\r\n     const route = useRoute();\r\n     const { t } = useI18n()\r\n     const data = reactive({\r\n       $t: t,\r\n       themeMode: computed(() => store.state.themeMode),\r\n       rate: computed(() => store.state.rate),\r\n       web3: computed(() => store.state.provider),\r\n       address: computed(() => store.state.accounts[0]),\r\n       ieoContract: null,\r\n       tokenContract: null,\r\n       kis: config.kisAddress,\r\n       tokenAllowance: 0,\r\n       amount: '',\r\n       haveAmount: '',\r\n       kisAmount: computed(() => {\r\n         if (data.amount) {\r\n           return Number(data.amount / 2).toFixed(2)\r\n         }\r\n         return 0;\r\n       }),\r\n       id: route.params.id,\r\n       project: null,\r\n       initContract: () => {\r\n         data.ieoContract = new data.web3.eth.Contract(ikoAbi, config.iko)\r\n         data.tokenContract = new data.web3.eth.Contract(tokenAbi, config.usdtAddress)\r\n         data.getTokenAllowance()\r\n         data.getInfo()\r\n       },\r\n       initWallet: () => {\r\n         web3Data.initWeb3()\r\n       },\r\n       getTokenAllowance: () => {\r\n        data.tokenContract.methods.allowance(data.address, config.iko).call().then((amount) => {\r\n          data.tokenAllowance = amount;\r\n        })\r\n       },\r\n       approveToken: () => {\r\n         data.tokenContract.methods.approve(config.iko, MaxUint256).send({from: data.address}).then((result) => {\r\n          data.getTokenAllowance()\r\n        })\r\n       },\r\n       getInfo: async () => {\r\n         let amount = await data.ieoContract.methods.haveBuyAmount().call();\r\n         data.haveAmount = new BigNumber(amount).dividedBy(Math.pow(10, 18)).toFixed()\r\n       },\r\n       swap: async () => {\r\n         if (!data.amount) {\r\n           ElMessage.error(data.$t('ieo.请输入兑换数量'));\r\n           return\r\n         }\r\n        let tokenContract = new data.web3.eth.Contract(tokenAbi, config.kisAddress)\r\n        let decimals = await tokenContract.methods.decimals().call();\r\n        let amount = new BigNumber(data.amount).multipliedBy(Math.pow(10, decimals)).toFixed()\r\n        await data.ieoContract.methods.invest(amount).send({from: data.address})\r\n       }\r\n     })\r\n    \r\n     if (data.address) {\r\n       data.initContract()\r\n     }\r\n     watch(() => data.address, (val) => {\r\n       if (val) {\r\n         data.initContract()\r\n       }\r\n     })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.top-text {\r\n  color: #fff;\r\n  font-size: 18px;\r\n  text-align: center;\r\n  margin: 26px 0 13px;\r\n}\r\n.info-box{\r\n  font-size: 16px;\r\n  margin-top: 20px;\r\n}\r\n.form-block {\r\n  width: 658px;\r\n  height: 438px;\r\n  margin: 0 auto 190px;\r\n  padding: 87px 70px 90px;\r\n  background: url('~@/assets/image/ieo/border2.png') no-repeat 0 0;\r\n  background-size: 100% 100%;\r\n  .cell-row {\r\n    background: #fff;\r\n    height: 96px;\r\n    padding: 0 21px;\r\n    .label {\r\n      font-size: 24px;\r\n      color: #212429;\r\n    }\r\n    .cont {\r\n      .input-style {\r\n        width: 100%;\r\n        text-align: right;\r\n        font-size: 22px;\r\n        color: #188277;\r\n        font-weight: bold;\r\n        border: 0;\r\n        outline: none;\r\n      }\r\n    }\r\n  }\r\n  .cell-msg {\r\n    font-size: 22px;\r\n    color: #08E8CE;\r\n    text-align: right;\r\n    margin: 14px 0;\r\n  }\r\n  .form-btn {\r\n    margin: 37px auto 0;\r\n    width: 500px;\r\n    height: 61px;\r\n    color: #fff;\r\n    line-height: 61px;\r\n    font-size: 18px;\r\n    text-align: center;\r\n    font-weight: bold;\r\n    background: url('~@/assets/image/liquidity/btn_bg1.png') no-repeat 0 0;\r\n    background-size: 100% 100%;\r\n    transition: all 0.3s;\r\n    cursor: pointer;\r\n    &:hover {\r\n      background-image: url('~@/assets/image/liquidity/btn_bg4.png');\r\n    }\r\n  }\r\n}\r\n.theme-light {\r\n  .top-text {\r\n    color: #333;\r\n  }\r\n  .form-block {\r\n    background-image: url('~@/assets/image/light/ieo/border2.png');\r\n    .cell-row {\r\n      box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.24);\r\n      .cont {\r\n        .input-style {\r\n          color: #3A7343;\r\n        }\r\n      }\r\n    }\r\n    .cell-msg {\r\n      color: #3A7343;\r\n    }\r\n    .form-btn {\r\n      background-image: url('~@/assets/image/light/liquidity/btn_bg1.png');\r\n      color: #3A7343;\r\n      &:hover {\r\n        color: #AD7805;\r\n        background-image: url('~@/assets/image/light/liquidity/btn_bg4.png');\r\n      }\r\n    }\r\n  }\r\n}\r\n@media screen and (max-width: 480px) {\r\n  .top-text {\r\n    font-size: 14px;\r\n    padding: 0 12px;\r\n  }\r\n  .form-block {\r\n    width: 100%;\r\n    height: auto;\r\n    margin: 0 auto 120px;\r\n    padding: 48px 30px 40px;\r\n    .cell-row {\r\n      height: 50px;\r\n      padding: 0 12px;\r\n      .label {\r\n        font-size: 16px;\r\n      }\r\n      .cont .input-style {\r\n        font-size: 18px;\r\n      }\r\n    }\r\n    .cell-msg {\r\n      font-size: 14px;\r\n    }\r\n    .form-btn {\r\n      height: 50px;\r\n      line-height: 50px;\r\n      margin: 20px auto 0;\r\n      width: 100%;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=ae79fb3e&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=ae79fb3e&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-ae79fb3e\"\n\nexport default script"],"sourceRoot":""}