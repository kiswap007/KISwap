{"version":3,"sources":["webpack:///./src/views/vote/detail.vue?f73d","webpack:///./src/views/vote/detail.vue","webpack:///./src/views/vote/detail.vue?b27b"],"names":["class","h1","h4","$t","endtime","votes","item","index","key","title","select","radioIds","id","oplist","cItem","cIndex","label","checkChange","options_name","radioChange","isVoted","submit","components","IndexTop","setup","router","t","data","getVoteInfo","then","res","i","length","push","name","end_time","ip","flag","ids","names","forEach","error","console","log","success","go","info","citem","idItem","oplistItem","refData","render","__scopeId"],"mappings":"uIAAA,W,4JCCOA,MAAM,Q,GAIJA,MAAM,e,GACJA,MAAM,Y,GAEJA,MAAM,a,mBACNA,MAAM,e,SAKNA,MAAM,e,SAMRA,MAAM,gB,4UAnBf,yBAsBM,MAtBN,EAsBM,CArBJ,yBAE0E,GADvEC,GAAI,GACJC,GAAI,EAAAC,GAAE,kD,eACT,yBAiBM,MAjBN,EAiBM,CAhBJ,yBAA2D,MAA3D,EAA2D,6BAAnC,EAAAA,GAAE,cAAe,IAAC,6BAAE,EAAAC,SAAO,I,2BACnD,yBAYM,2CAZyC,EAAAC,OAAK,SAArBC,EAAMC,G,gCAArC,yBAYM,OAZDP,MAAM,YAA4CQ,IAAKD,G,CAC1D,yBAA8F,MAA9F,EAA8F,C,0DAArED,EAAKG,OAAK,GAAcH,EAAKI,Q,yBAAjB,yBAAmD,sCAAxB,EAAAP,GAAE,kB,yCAClCG,EAAKI,Q,yBAKrC,yBAIM,MAJN,EAIM,CAHJ,yBAEoB,G,WAFQ,EAAAC,SAASJ,GAAOK,G,yCAAhB,EAAAD,SAASJ,GAAOK,GAAE,I,YAC/B,iBAAsC,E,2BAAnD,yBAA0K,2CAAnIN,EAAKO,QAAM,SAA7BC,EAAOC,G,gCAA5B,yBAA0K,GAArHP,IAAKO,EAASC,MAAOF,EAAMF,GAAK,SAAM,mBAAE,EAAAK,YAAYX,EAAMC,EAAOO,EAAOC,K,YAAS,iBAAsB,C,0DAApBD,EAAMI,cAAY,O,0HAP9J,yBAIM,MAJN,EAIM,CAHJ,yBAEiB,G,WAFQ,EAAAP,SAASJ,GAAOK,G,yCAAhB,EAAAD,SAASJ,GAAOK,GAAE,I,YAC/B,iBAAsC,E,2BAAhD,yBAAsJ,2CAAlHN,EAAKO,QAAM,SAA7BC,EAAOC,G,gCAAzB,yBAAsJ,GAApGP,IAAKO,EAASC,MAAOF,EAAMF,GAAK,SAAM,mBAAE,EAAAO,YAAYL,EAAOP,K,YAAQ,iBAAsB,C,0DAApBO,EAAMI,cAAY,O,2GAS/G,EAAAE,S,yBAAhC,yBAAiE,MAAjE,EAAiE,6BAAtB,EAAAjB,GAAE,kB,yBAC7C,yBAA+D,O,MAA1DH,MAAM,MAAO,QAAK,8BAAE,EAAAqB,QAAA,EAAAA,OAAA,sB,6BAAiB,EAAAlB,GAAE,uB,8HAWnC,GACbmB,WAAY,CACVC,WAAA,MAEFC,MAJa,WAKX,IAAMC,EAAS,iBADR,EAEO,iBAANC,EAFD,EAECA,EACFC,EAAO,sBAAS,CACpBxB,GAAIuB,EACJf,SAAU,GACVN,MAAO,GACPD,QAAS,GACTgB,QAAS,EACTQ,YAAY,WACV,iBAAUC,MAAK,SAACC,GAEd,IAAI,IAAIC,EAAI,EAAGA,EAAID,EAAIH,KAAKK,OAAQD,IAC9BD,EAAIH,KAAKI,GAAGrB,OACdiB,EAAKhB,SAASsB,KAAK,CACjBxB,MAAOqB,EAAIH,KAAKI,GAAGtB,MACnBG,GAAI,GACJsB,KAAM,GACNxB,OAAQoB,EAAIH,KAAKI,GAAGrB,SAGtBiB,EAAKhB,SAASsB,KAAK,CACjBxB,MAAOqB,EAAIH,KAAKI,GAAGtB,MACnBG,GAAI,GACJsB,KAAM,GACNxB,OAAQoB,EAAIH,KAAKI,GAAGrB,SAK1BiB,EAAKvB,QAAU0B,EAAIH,KAAK,GAAGQ,SAC3BR,EAAKP,QAAUU,EAAIH,KAAK,GAAGS,GAC3BT,EAAKtB,MAAQyB,EAAIH,SAGrBN,OAAQ,WACN,IAAIgB,GAAO,EACPC,EAAM,GACNC,EAAQ,GAEZZ,EAAKhB,SAAS6B,SAAQ,SAAAlC,IACfA,EAAKI,SAAWJ,EAAKM,GAAGoB,SAAa1B,EAAKI,SAAWJ,EAAKM,MAE7DyB,GAAO,GAEN/B,EAAKI,QAEN4B,EAAE,yBAAQA,GAAR,eAAgBhC,EAAKM,KACvB2B,EAAI,yBAAQA,GAAR,eAAkBjC,EAAK4B,SAE3BI,EAAIL,KAAK3B,EAAKM,IACd2B,EAAMN,KAAK3B,EAAK4B,UAKhBG,EACF,OAAUI,MAAMd,EAAKxB,GAAG,eAG1B,eAAW,CAACS,GAAI0B,EAAKpB,aAAcqB,IAAQV,MAAK,SAACC,GAC/CY,QAAQC,IAAIb,GACRA,EAAIH,MACN,OAAUiB,QAAQjB,EAAKxB,GAAG,cAC1BsB,EAAOoB,IAAI,IAEX,OAAUJ,MAAMX,EAAIgB,UAI1B3B,YAAa,SAAC4B,EAAOxC,GAGnBoB,EAAKhB,SAASJ,GAAO2B,KAAOa,EAAM7B,cAEpCD,YAAa,SAACX,EAAMC,EAAOO,EAAOC,GAChCY,EAAKhB,SAASJ,GAAO2B,KAAO,GACxBP,EAAKhB,SAASJ,GAAOK,GAAGoB,QAC1BL,EAAKhB,SAASJ,GAAOK,GAAG4B,SAAQ,SAACQ,GAC/B1C,EAAKO,OAAO2B,SAAQ,SAAAS,GACdA,EAAWrC,KAAOoC,GACpBrB,EAAKhB,SAASJ,GAAO2B,KAAKD,KAAKgB,EAAW/B,uBAOtDS,EAAKC,cAEL,IAAMsB,EAAU,oBAAOvB,GACvB,yBACKuB,K,UC3HT,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"static/js/VoteDetail.4e5b8576.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./detail.vue?vue&type=style&index=0&id=22f30d57&lang=scss&scoped=true\"","<template>\r\n  <div class=\"page\">\r\n    <index-top \r\n      :h1=\"''\"\r\n      :h4=\"$t('index.打造DeFi生态最大的集为一体的平台', {word: 'DEX.IMO.DAO'})\"></index-top>\r\n    <div class=\"approve-box\">\r\n      <div class=\"tit-time\">{{$t('vote.截止时间')}}：{{endtime}}</div>\r\n      <div class=\"radio-box\" v-for=\"(item, index) in votes\" :key=\"index\">\r\n        <div class=\"radio-tit\">{{item.title}}<span v-if=\"item.select\">{{$t('vote.（多选）')}}</span></div>\r\n        <div class=\"radio-group\" v-if=\"!item.select\">\r\n          <el-radio-group v-model=\"radioIds[index].id\">\r\n            <el-radio v-for=\"(cItem, cIndex) in item.oplist\" :key=\"cIndex\" :label=\"cItem.id\" @change=\"radioChange(cItem, index)\">{{cItem.options_name}}</el-radio>\r\n          </el-radio-group>\r\n        </div>\r\n        <div class=\"radio-group\" v-else>\r\n          <el-checkbox-group v-model=\"radioIds[index].id\">\r\n            <el-checkbox v-for=\"(cItem, cIndex) in item.oplist\" :key=\"cIndex\" :label=\"cItem.id\" @change=\"checkChange(item, index, cItem, cIndex)\">{{cItem.options_name}}</el-checkbox>\r\n          </el-checkbox-group>\r\n        </div>\r\n      </div>\r\n      <div class=\"btn disabled\" v-if=\"isVoted\">{{$t('vote.已提交')}}</div>\r\n      <div class=\"btn\" @click=\"submit\" v-else>{{$t('vote.提交')}}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { reactive, toRefs } from \"vue\";\r\nimport IndexTop from \"@/views/index/IndexTop\";\r\nimport { getVote, submitVote } from \"@/api\"\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { ElMessage } from \"element-plus\";\r\nexport default {\r\n  components: {\r\n    IndexTop\r\n  },\r\n  setup () {\r\n    const router = useRouter();\r\n    const { t } = useI18n()\r\n    const data = reactive({\r\n      $t: t,\r\n      radioIds: [],\r\n      votes: [],\r\n      endtime: '',\r\n      isVoted: 0,\r\n      getVoteInfo:() => {\r\n        getVote().then((res) => {\r\n          // console.log(res.data.length)\r\n          for(let i = 0; i < res.data.length; i++) {\r\n            if (res.data[i].select) {\r\n              data.radioIds.push({\r\n                title: res.data[i].title,\r\n                id: [],\r\n                name: [],\r\n                select: res.data[i].select\r\n              })\r\n            } else {\r\n              data.radioIds.push({\r\n                title: res.data[i].title,\r\n                id: '',\r\n                name: '',\r\n                select: res.data[i].select\r\n              })\r\n            }\r\n          }\r\n          // console.log(data.radioIds)\r\n          data.endtime = res.data[0].end_time\r\n          data.isVoted = res.data[0].ip\r\n          data.votes = res.data\r\n        })\r\n      },\r\n      submit: () => {\r\n        let flag = false\r\n        let ids = []\r\n        let names = []\r\n        // console.log(data.radioIds)\r\n        data.radioIds.forEach(item => {\r\n          if ((item.select && !item.id.length) || (!item.select && !item.id)) {\r\n            // console.log(item.title)\r\n            flag = true\r\n          }\r\n          if(item.select) {\r\n            // console.log(item.id)\r\n            ids = [...ids, ...item.id]\r\n            names = [...names, ...item.name]\r\n          } else {\r\n            ids.push(item.id)\r\n            names.push(item.name)\r\n          }\r\n        })\r\n        // console.log(ids)\r\n        // console.log(names)\r\n        if (flag) {\r\n          ElMessage.error(data.$t('vote.请完善选项'));\r\n          return\r\n        }\r\n        submitVote({id: ids, options_name: names}).then((res) => {\r\n          console.log(res)\r\n          if (res.data) {\r\n            ElMessage.success(data.$t('vote.提交成功'));\r\n            router.go(-1)\r\n          } else {\r\n            ElMessage.error(res.info);\r\n          }\r\n        })\r\n      },\r\n      radioChange: (citem, index) => {\r\n        // console.log(citem)\r\n        // console.log(data.radioIds)\r\n        data.radioIds[index].name = citem.options_name\r\n      },\r\n      checkChange: (item, index, cItem, cIndex) => {\r\n        data.radioIds[index].name = []\r\n        if (data.radioIds[index].id.length) {\r\n          data.radioIds[index].id.forEach((idItem) => {\r\n            item.oplist.forEach(oplistItem => {\r\n              if (oplistItem.id === idItem) {\r\n                data.radioIds[index].name.push(oplistItem.options_name)\r\n              }\r\n            })\r\n          })\r\n        }\r\n      }\r\n    })\r\n    data.getVoteInfo()\r\n\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.approve-box {\r\n  width: 1200px;\r\n  background: rgba(255, 255, 255, 0.1);\r\n  margin: 30px auto 22px;\r\n  padding: 24px 108px 0;\r\n  font-size: 16px;\r\n  color: #fff;\r\n  overflow: hidden;\r\n  .tit-time {\r\n    font-size: 20px;\r\n    color: #08E8CE;\r\n    margin-bottom: 16px;\r\n  }\r\n  .btn {\r\n    width: 392px;\r\n    height: 72px;\r\n    text-align: center;\r\n    margin: 41px auto 67px;\r\n    background: url('~@/assets/image/liquidity/btn_bg1.png') no-repeat center;\r\n    background-size: 100% 100%;\r\n    color: #fff;\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n    line-height: 72px;\r\n    cursor: pointer;\r\n    transition: all .3s;\r\n    user-select: none;\r\n    &:hover {\r\n      background-image: url('~@/assets/image/liquidity/btn_bg4.png');\r\n    }\r\n    &.disabled {\r\n      color: #AAB0B5;\r\n      background-image: url('~@/assets/image/liquidity/btn_bg1_dis.png');\r\n    }\r\n  }\r\n}\r\n.radio-box {\r\n  .radio-tit {\r\n    padding: 20px 0;\r\n  } \r\n}\r\n.theme-light{\r\n  .approve-box {\r\n    background: rgba(255, 255, 255, 0.5);\r\n    box-shadow: 0px -4px 30px 0px rgba(0, 0, 0, 0.18);\r\n    color: #333333;\r\n    .tit-time {\r\n      color: #3A7343;\r\n    }\r\n    .btn {\r\n      background-image: url('~@/assets/image/light/liquidity/btn_bg1.png');\r\n      color: #3A7343;\r\n      &:hover {\r\n        color: #AD7805;\r\n        background-image: url('~@/assets/image/light/liquidity/btn_bg4.png');\r\n      }\r\n      &.disabled {\r\n        color: #88A78D;\r\n        background-image: url('~@/assets/image/light/liquidity/btn_bg1_dis.png');\r\n      }\r\n    }\r\n  }\r\n}\r\n@media screen and (max-width: 480px) {\r\n  .approve-box {\r\n    width: 100%;\r\n    padding: 15px;\r\n    font-size: 14px;\r\n    .tit-time {\r\n      font-size: 16px;\r\n      margin-bottom: 0;\r\n    }\r\n    .btn {\r\n      width: 272px;\r\n      height: 50px;\r\n      line-height: 50px;\r\n      font-size: 15px;\r\n    }\r\n  }\r\n  .radio-box {\r\n    .radio-tit {\r\n      padding: 20px 0 10px;\r\n    } \r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./detail.vue?vue&type=template&id=22f30d57&scoped=true\"\nimport script from \"./detail.vue?vue&type=script&lang=js\"\nexport * from \"./detail.vue?vue&type=script&lang=js\"\n\nimport \"./detail.vue?vue&type=style&index=0&id=22f30d57&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-22f30d57\"\n\nexport default script"],"sourceRoot":""}